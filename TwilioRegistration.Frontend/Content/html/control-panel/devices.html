<!-- Page Heading -->
<div class="row">
    <div class="col-lg-12">
        <h1 class="page-header">
            Devices
        </h1>
        <ol class="breadcrumb">
            <li>
                <i class="fa fa-dashboard"></i> <a href="/control-panel">Dashboard</a>
            </li>
            <li class="active">
                <i class="glyphicon glyphicon-phone-alt"></i> Devices
            </li>
        </ol>
    </div>
</div>
<!-- /.row -->
<div class="row">
    <div class="col-lg-12" ng-show="ctrl.action=='list'">
        <div class="table-responsive" ng-show="ctrl.devices.length > 0">
            <table class="table table-hover table-striped" at-table at-list="ctrl.devices" at-paginated at-config="ctrl.config">
                <thead>
                </thead>
                <tbody>
                    <tr>
                        <td at-implicit at-attribute="username" at-sortable at-initial-sorting="asc"></td>
                        <td at-implicit at-attribute="status" at-sortable></td>
                        <td at-implicit at-attribute="createdAt" at-sortable></td>
                        <td>
                            <a href="#" class="btn btn-xs btn-primary" role="button" ng-click="ctrl.changePassword(item)">Change Password</a>
                            <a href="#" class="btn btn-xs btn-danger" role="button" ng-click="ctrl.deleteDevice(item)">Delete</a>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <at-pagination at-list="ctrl.devices" at-config="ctrl.config" ng-show="ctrl.devices.length > ctrl.config.itemsPerPage"></at-pagination>
        <div class="table-responsive" ng-hide="ctrl.devices.length > 0">
            <table class="table table-hover table-striped">
                <thead>
                    <tr>
                        <th>Username</th>
                        <th>Status</th>
                        <th>Created At</th>
                        <th>&nbsp;</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td colspan="4">You have no devices (yet). <a href="/control-panel/devices/add">Click here</a> to add one</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="text-center">
            <a href="/control-panel/devices/add" class="btn btn-primary btn-lg" role="button">Add Device</a>
        </div>
    </div>
    <div class="col-lg-12" ng-show="ctrl.action=='add'">
        <form role="form" name="addDeviceForm" ng-submit="ctrl.addDevice(addDeviceForm)" novalidate>
            <div class="form-group">
                <label>Username</label>
                <input class="form-control" name="username" ng-model="ctrl.newDevice.username" required ng-pattern="/^[a-zA-Z0-9]+$/" />
                <p class="help-block">It's <a href="http://www.asteriskdocs.org/en/3rd_Edition/asterisk-book-html-chunk/DeviceConfig_id216341.html" target="_blank">considered good practice</a> to use your device's MAC as username</p>
            </div>
            <div class="form-group">
                <label>Password</label>
                <input class="form-control" name="password" ng-model="ctrl.newDevice.password" type="password" required ng-minlength="8" />
                <p class="help-block">Your password is going to be stored as the md5secret of the device in Asterisk (because I haven't found a way to do it better <a href="http://www.voip-info.org/wiki/view/Asterisk+sip+md5secret" target="_blank">than this</a>). Considering that md5 "<a href="http://www.kb.cert.org/vuls/id/836068" target="_blank">should be considered cryptographically broken and unsuitable for further use</a> don't use any of your important passwords.</p>
            </div>
            <button type="submit" class="btn btn-primary">Add Device</button> <a href="/control-panel/devices" class="btn btn-danger">Cancel</a>
        </form>
    </div>
</div>
<!-- /.row -->
